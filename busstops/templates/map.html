{% extends 'page.html' %}

{% block title %}Map – timesbus.org{% endblock %}

{% block head %}
    <meta property="og:title" content="Map – timesbus.org">
{% endblock head %}

{% block bodyclass %}no-scroll{% endblock %}

{% block header %}
    {% comment %}
        We can get the current month using the 'now' template tag and then
        applying the 'date' filter with the format code for month.
    {% endcomment %}
    {% now "m" as current_month_str %}

    {% comment %}
        The 'now "m"' tag returns the month as a string (e.g., "01" for Jan, "06" for Jun).
        We need to compare it to "06" for June.
    {% endcomment %}
   <header class="site-header">
        <a href="/" class="site-name">
        {% if '/operators/nasa' in request.path %}
            <!-- fly like an eagle, to de sea :3 -->
            <img src="https://assets.timesbus.org/timesspace.svg" height="28px" alt="NASA Operator Logo" />
        {% elif current_month_str == "06" %}
            <!-- HAHA FAGGOR MUNF :3 -->
            <img src="https://assets.timesbus.org/gaytimes.svg" height="28px" />
        {% else %}
            <!-- time for the normals ig -->
            <img src="https://assets.timesbus.org/logo.svg" height="28px" />
        {% endif %}
        </a>
        <ul>
            <li><a href="/map{% if object.latlong %}#16/{{ object.latlong.y|floatformat:4 }}/{{ object.latlong.x|floatformat:4 }}{% endif %}" style="color: #ffffff">Map</a></li>
        </ul>
        <form method="GET" action="/search" class="search">
            <label>
                Search
                <input name="q" placeholder="Search" type="search" value="{{ query }}" required>
            </label>
            <input type="submit" value="Search" style="color: #ffffff">
        </form>
    </header>
{% endblock header %}

{% block breadcrumb %}{% endblock %}

{% block content %}
    <div id="hugemap">
        <noscript class="sorry">Sorry, the map requires JavaScript. You can still use most of the rest of the website.</noscript>
    </div>
{% endblock content %}

{% load static %}

{% block footer %}
    <script>
        INITIAL_VIEW_STATE = {
        {% if request.headers.cf_ipcountry == "IE" %}
            latitude: 53.45,
            longitude: -7.5,
        {% else %}
            latitude: 54,
            longitude: -2.9,
        {% endif %}
            zoom: 5,
        };
        OLD_JS = [
            "{% static 'js/reqwest.min.js' %}",
            "{% static 'dist/js/bigmap-classic.css' %}",
            "{% static 'dist/js/bigmap-classic.js' %}"
        ];
        NEW_JS = [
            "{% static 'dist/js/app.css' %}",
            "{% static 'dist/js/app.js' %}",
        ];
    </script>
    <script src="{% static 'dist/js/bigmap.js' %}"></script>
    <link rel="stylesheet" media="print" href="/liveries.{{ liveries_css_version }}.css" onload="this.onload=null;this.removeAttribute('media')">
{% endblock footer %}
